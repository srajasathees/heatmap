<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Heatmap Example</title>
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
	<link rel="stylesheet" href="css/leaflet.css" />
	<script src="js/leaflet.js"></script>
  </head>

  <body>
    <header>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="#">HeatMap</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <!--<div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#">Disabled</a>
            </li>
          </ul>
        </div>-->
      </nav>
    </header>

    <!-- Begin page content -->
    <main role="main" class="container-fluid" style="margin-top: 60px;">
	
      <div class="wrapper">
		<div class="demo-wrapper">
			<div class="heatmap" id="map-canvas" style="100%; height:800px;"></div>
		</div>
    </div>
	  
    </main>

    <footer class="footer">
      <div class="container">
        <span class="text-muted">Place sticky footer content here.</span>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
	<script src="js/heatmap.min.js"></script>
	<script src="js/leaflet-heatmap.js"></script>
	<script>
    window.onload = function() {
		var ArrData = {
		"heatmap" : [{lat: 25.090573819461003, lng:55.1898193359375, count: 3},{lat: 25.298406380236287, lng:55.33470153808594, count: 5},{lat: 25.24749072145161, lng:55.30723571777344, count: 6},{lat: 24.956802552408003, lng:55.496063232421875, count: 5},{lat: 25.087464516663005, lng:55.14965057373047, count: 2},{lat: 25.156472435986753, lng:55.2337646484375, count: 6},{lat: 25.26945848068275, lng:55.37753105163574, count: 4},{lat: 25.267857607762174, lng:55.29342770576477, count: 3},{lat: 25.222956656315972, lng:55.37753105163574, count: 2},{lat: 25.248732820881806, lng:55.28474807739258, count: 7},{lat: 24.97158677046404, lng:55.186214447021484, count: 3},{lat: 25.148703221680663, lng:55.22226333618164, count: 5},{lat: 24.96427269508287, lng:55.07549285888672, count: 4},{lat: 25.203543287558045, lng:55.28449058532715, count: 2},{lat: 25.255952272383983, lng:55.328049659729004, count: 1},{lat: 24.806369709591422, lng:56.12348556518555, count: 3},{lat: 24.919818676597483, lng:55.004425048828125, count: 6}],
		
		"area_details" : [
		{"name" : "Al Barsha Fire Station", "color":"#13d8aa", "path" : [[40.63844629557923,45.4779052734375],[40.64730356252251,45.4888916015625],[40.66345202337168,45.49781799316406],[40.66813955408042,45.512237548828125],[40.66918118282895,45.53009033203125],[40.659285052824394,45.539703369140625],[40.65147128144057,45.55686950683594],[40.63896734381723,45.556182861328125],[40.62541876792774,45.550689697265625],[40.61864344909241,45.5548095703125],[40.616558597344756,45.5438232421875],[40.6113461833302,45.523223876953125],[40.602484146302096,45.52665710449219],[40.59414233212419,45.51567077636719],[40.5868423908791,45.50056457519531],[40.60039879034164,45.4888916015625],[40.614473680534935,45.48614501953125],[40.62437645591559,45.479278564453125],[40.629587853312174,45.47515869140625]]},
		
		{"name" : "Al Hamriyah", "color":"#FFAF00", "path" : [[25.123838412630686,55.19960403442383],[25.10705180512959,55.17660140991211],[25.093216664721815,55.159950256347656],[25.079379959695842,55.1432991027832],[25.065852680192616,55.130767822265625],[25.04859156855236,55.14535903930664],[25.041126551200882,55.15514373779297],[25.03132802633444,55.16630172729492],[25.019195435134403,55.15668869018555],[25.003016781570135,55.17557144165039],[24.998349466241233,55.18363952636719],[24.99617132508261,55.190162658691406],[24.991503749746393,55.213165283203125],[24.984968846504753,55.228271484375],[24.980612051373313,55.236167907714844],[24.980456448692344,55.23857116699219],[24.996949237071213,55.249385833740234],[25.011261938649263,55.26552200317383],[25.023395313968287,55.2777099609375],[25.03754940267705,55.25625228881836],[25.043692702175115,55.25273323059082],[25.050146723295246,55.24955749511719],[25.054112278593635,55.249128341674805],[25.058388714052015,55.24921417236328],[25.07051742811325,55.24921417236328],[25.082800414347187,55.249385833740234],[25.093993961287644,55.242862701416016],[25.109383416250306,55.22106170654297],[25.120108254653992,55.204925537109375]]},
		
		{"name" : "Al Karama", "color":"#3fff00", "path" : [[25.276211021345937,55.29521942138672],[25.287542026764452,55.291099548339844],[25.29437116258816,55.29024124145508],[25.296388788201572,55.28715133666992],[25.30507971464154,55.28165817260742],[25.3154769684244,55.27925491333008],[25.317028720815934,55.27496337890625],[25.32044250609558,55.2751350402832],[25.327890430844278,55.25779724121094],[25.344336308014682,55.247154235839844],[25.368070282624217,55.246124267578125],[25.384045431660546,55.254878997802734],[25.385596304477392,55.27788162231445],[25.371637732118533,55.30036926269531],[25.352558408332573,55.312042236328125],[25.351937891960915,55.319766998291016],[25.34294004678588,55.3297233581543],[25.324942348747847,55.332298278808594],[25.32292519858319,55.33367156982422],[25.326183655222557,55.33538818359375],[25.326959465306306,55.33985137939453],[25.326183655222557,55.34242630004883],[25.321994194865383,55.341739654541016],[25.31780458955644,55.338993072509766],[25.310976774071104,55.337791442871094],[25.310976774071104,55.339508056640625],[25.299958351258493,55.350494384765625],[25.297785586263682,55.354957580566406],[25.301510302409604,55.357704162597656],[25.30771790828541,55.352210998535156],[25.312528584111995,55.34963607788086],[25.30166549643176,55.360107421875],[25.299647958643693,55.36182403564453],[25.285213824377006,55.35890579223633],[25.27512443097316,55.348262786865234],[25.27046750488758,55.3300666809082],[25.27015703679491,55.315818786621094],[25.27636624774774,55.31496047973633],[25.27838417290058,55.31444549560547],[25.278539396522223,55.309810638427734],[25.281643827250683,55.3080940246582]]},
		
		{"name" : "Al Lisaili", "color":"#ff0090", "path" : [[25.26518943931062,55.30139923095703],[25.262317454282908,55.30045509338379],[25.258319848523342,55.297837257385254],[25.255176007864865,55.30436038970947],[25.254865500668014,55.304789543151855],[25.24795651022605,55.300583839416504],[25.23029410295275,55.29036998748779],[25.230138817662514,55.29097080230713],[25.232895102083088,55.303030014038086],[25.232817461123688,55.309081077575684],[25.23083759990687,55.31332969665527],[25.22959531758496,55.315561294555664],[25.223150774361578,55.31590461730957],[25.215075202064376,55.314273834228516],[25.207193237268164,55.313029289245605],[25.202611367966746,55.310025215148926],[25.200087383251443,55.309553146362305],[25.200087383251443,55.311055183410645],[25.202028914599655,55.31264305114746],[25.204514029546484,55.31435966491699],[25.20548476379409,55.317063331604004],[25.20548476379409,55.32118320465088],[25.20567890971466,55.3286075592041],[25.20552359300296,55.33156871795654],[25.204436370472273,55.33294200897217],[25.205057641678845,55.33337116241455],[25.205329446834664,55.332770347595215],[25.20560125138361,55.33345699310303],[25.205911884410657,55.334229469299316],[25.208513404892074,55.335731506347656],[25.212085551373107,55.33637523651123],[25.214997549728825,55.33967971801758],[25.218918930732258,55.34435749053955],[25.220122497571072,55.34517288208008],[25.22082133736792,55.34495830535889],[25.221869589535547,55.34534454345703],[25.22241312414016,55.34512996673584],[25.223073127180506,55.345473289489746],[25.22559663519191,55.344486236572266],[25.226489556254503,55.34435749053955],[25.228702419326634,55.34285545349121],[25.228547132003747,55.342512130737305],[25.227964802776707,55.341739654541016],[25.228353022571238,55.34096717834473],[25.229012993377527,55.34169673919678],[25.229440031402337,55.34079551696777],[25.22947885296658,55.340280532836914],[25.228624775689973,55.33937931060791],[25.22808126884519,55.339250564575195],[25.229090636766305,55.338993072509766],[25.229944710770837,55.33989429473877],[25.23029410295275,55.33963680267334],[25.229905889355315,55.33912181854248],[25.23021646033244,55.33890724182129],[25.230682315310734,55.339293479919434],[25.230954063223844,55.33886432647705],[25.229711782091815,55.33770561218262],[25.230488209286683,55.337491035461426],[25.230954063223844,55.33809185028076],[25.231575199030285,55.338478088378906],[25.231885765743584,55.33809185028076],[25.231186989523096,55.337276458740234],[25.232002228056547,55.336289405822754],[25.2328562816096,55.33684730529785],[25.233205665424848,55.336289405822754],[25.23246807619283,55.335774421691895],[25.233283306136336,55.33444404602051],[25.237747563651414,55.32920837402344],[25.238446302162636,55.3291654586792],[25.238252208534664,55.32865047454834],[25.23895094414486,55.3277063369751],[25.240154312724126,55.32813549041748],[25.241318851617844,55.32706260681152],[25.243143273449427,55.32667636871338],[25.24543346633793,55.326032638549805],[25.24729664226857,55.32491683959961],[25.248228219519795,55.32444477081299],[25.24818940394362,55.32384395599365],[25.24950912657709,55.322256088256836],[25.251488683646983,55.32041072845459],[25.25176038504095,55.31899452209473],[25.252730742201305,55.31847953796387],[25.253118882894977,55.317792892456055],[25.253274138825184,55.317020416259766],[25.25529244785901,55.314316749572754],[25.259872332410108,55.309810638427734],[25.26262794242607,55.30796527862549],[25.26383107648121,55.30564785003662],[25.265034198613645,55.303072929382324]]},
		
		]
		
		};
		
		console.log(ArrData['area_details']);
      var testData = {
          max: 8,
          data: ArrData['heatmap']
        };

        var baseLayer = L.tileLayer(
          'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
            maxZoom: 18
          }
        );

        var cfg = {
          // radius should be small ONLY if scaleRadius is true (or small radius is intended)
          "radius": .05,
          "maxOpacity": .8,
          // scales the radius based on map zoom
          "scaleRadius": true,
          // if set to false the heatmap uses the global maximum for colorization
          // if activated: uses the data maximum within the current map boundaries
          //   (there will always be a red spot with useLocalExtremas true)
          "useLocalExtrema": true,
          // which field name in your data represents the latitude - default "lat"
          latField: 'lat',
          // which field name in your data represents the longitude - default "lng"
          lngField: 'lng',
          // which field name in your data represents the data value - default "value"
          valueField: 'count'
        };


        var heatmapLayer = new HeatmapOverlay(cfg);

        var map = new L.Map('map-canvas', {
          center: new L.LatLng(25.259596360843, 55.291300792694),
          zoom: 10,
          layers: [baseLayer, heatmapLayer]
        });

        heatmapLayer.setData(testData);
		
		var details = ArrData['area_details'];
		
		details.forEach(async function(info) {
		  
			var polygon = L.polygon(info['path'], {color: info['color']});
			polygon.addTo(map).bindPopup(info['name']);
		  
		});
		
    };
  </script>
  </body>
</html>
